<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ù‡∏∂‡∏Å - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ</title>
    <style>
        :root { --primary: #1e3a8a; --accent: #ef4444; --bg: #f1f5f9; }
        body { font-family: 'Sarabun', sans-serif; background: var(--bg); padding: 20px; }
        .container { background: white; max-width: 1000px; margin: auto; padding: 40px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .header-box { border-bottom: 2px solid var(--primary); margin-bottom: 30px; padding-bottom: 10px; display: flex; justify-content: space-between; align-items: flex-end; }
        .grid-info { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px; }
        .form-group { display: flex; flex-direction: column; }
        label { font-weight: bold; margin-bottom: 5px; font-size: 0.95em; }
        input { padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; outline: none; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: #f8fafc; padding: 12px; text-align: left; border-bottom: 2px solid #e2e8f0; }
        td { padding: 12px; border-bottom: 1px solid #f1f5f9; }
        .total-display { margin-top: 30px; text-align: right; background: #fff1f2; padding: 20px; border-radius: 8px; border: 1px solid #fecaca; }
        .btn-add { background: #64748b; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; margin-top: 15px; }
        /* ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ */
        .btn-del { background: #fee2e2; color: #ef4444; border: 1px solid #fecaca; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .btn-del:hover { background: #ef4444; color: white; }
        .btn-submit { background: var(--primary); color: white; border: none; width: 100%; padding: 15px; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-box">
        <div>
            <h1 style="margin:0; color:var(--primary);">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏™‡∏ô‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ù‡∏∂‡∏Å</h1>
            <p style="margin:5px 0 0 0; color:#64748b;">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏ì‡∏¥‡∏ä‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏≤‡∏á‡∏ô‡∏≤ (BNCC)</p>
        </div>
        <div class="form-group" style="width: 200px;">
            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠‡∏ã‡∏∑‡πâ‡∏≠</label>
            <input type="date" id="currentDate">
        </div>
    </div>

    <div class="grid-info">
        <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô</label><input type="text" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"></div>
        <div class="form-group"><label>‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤</label><input type="text" placeholder="3XXXX-XXXX"></div>
        <div class="form-group"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤</label><input type="text" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤"></div>
    </div>

    <table>
        <thead>
            <tr>
                <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏™‡∏î‡∏∏</th>
                <th width="100">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                <th width="120">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                <th width="120">‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th>
                <th width="50">‡∏•‡∏ö</th>
            </tr>
        </thead>
        <tbody id="items-body">
            <tr>
                <td><input type="text" style="width:90%" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏™‡∏î‡∏∏"></td>
                <td><input type="number" class="qty" value="1" oninput="calc()"></td>
                <td><input type="number" class="price" value="0.00" oninput="calc()"></td>
                <td><input type="text" class="row-total" value="0.00" readonly style="background:#f8fafc; border:none; text-align:right;"></td>
                <td></td> </tr>
        </tbody>
    </table>

    <button type="button" class="btn-add" onclick="addRow()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏™‡∏î‡∏∏</button>

    <div class="total-display">
        <span style="color:#475569;">‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô:</span>
        <div style="font-size: 24px; font-weight: bold; color: var(--accent);" id="grand-total">0.00 ‡∏ö‡∏≤‡∏ó</div>
    </div>

    <button class="btn-submit" onclick="submitData()">üöÄ ‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏ã‡∏∑‡πâ‡∏≠</button>


<script>
    document.getElementById('currentDate').valueAsDate = new Date();

    function addRow() {
        const body = document.getElementById('items-body');
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><input type="text" style="width:90%" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏™‡∏î‡∏∏"></td>
            <td><input type="number" class="qty" value="1" oninput="calc()"></td>
            <td><input type="number" class="price" value="0.00" oninput="calc()"></td>
            <td><input type="text" class="row-total" value="0.00" readonly style="background:#f8fafc; border:none; text-align:right;"></td>
            <td><button class="btn-del" onclick="removeRow(this)">‡∏•‡∏ö</button></td>
        `;
        body.appendChild(row);
        calc();
    }

    function removeRow(btn) {
        if(confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
            btn.closest('tr').remove();
            calc();
        }
    }

    function calc() {
        let total = 0;
        document.querySelectorAll('#items-body tr').forEach(row => {
            const q = row.querySelector('.qty').value || 0;
            const p = row.querySelector('.price').value || 0;
            const sum = q * p;
            row.querySelector('.row-total').value = sum.toLocaleString(undefined, {minimumFractionDigits: 2});
            total += sum;
        });
        document.getElementById('grand-total').innerText = total.toLocaleString(undefined, {minimumFractionDigits: 2}) + ' ‡∏ö‡∏≤‡∏ó';
    }
    // 1. ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ URL ‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏î Continue ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 17 ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzBtFBMb-TQNwcmBVLheztYXFWfJj2OgR9XTeR7DX7TQBh58We_gGMgvq0oAgWUF7Ai/exec"; 

async function submitData() {
    // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á
    const btn = document.querySelector('.btn-submit');
    const originalText = btn.innerText;
    btn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
    btn.disabled = true;

    // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    const data = {
        date: document.getElementById('currentDate').value,
        teacher: document.querySelector('input[placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"]').value,
        subjectCode: document.querySelector('input[placeholder="3XXXX-XXXX"]').value,
        subjectName: document.querySelector('input[placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤"]').value,
        items: []
    };

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    document.querySelectorAll('#items-body tr').forEach(row => {
        const nameInput = row.querySelector('input[type="text"]');
        if (nameInput && nameInput.value) {
            data.items.push({
                name: nameInput.value,
                qty: row.querySelector('.qty').value,
                price: row.querySelector('.price').value,
                total: (row.querySelector('.qty').value * row.querySelector('.price').value).toFixed(2)
            });
        }
    });

    try {
        // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google Sheets
        await fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors', // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏à‡∏≤‡∏Å GitHub ‡πÑ‡∏õ Google ‡πÑ‡∏î‡πâ
            cache: 'no-cache',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        alert('üöÄ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheets ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
        location.reload(); // ‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ö‡πÉ‡∏´‡∏°‡πà
    } catch (error) {
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
    } finally {
        btn.innerText = originalText;
        btn.disabled = false;
    }
}



</script>


</body>
</html>
